# Memory-Based Auto-Remediation Configuration Example
# This configuration demonstrates memory spike and OOMKill detection with automatic remediation

controller:
  metricsAddr: ":8080"
  probeAddr: ":8081"
  leaderElection: true

detection:
  evaluationInterval: 30s
  # Global defaults
  crashLoopThreshold: 3
  failedDeploymentThreshold: 5
  cpuThresholdPercent: 80.0
  memoryThresholdPercent: 85.0  # Memory usage threshold
  oomKillThreshold: 2           # OOMKill threshold for remediation
  
  # Namespace-specific memory settings
  namespaces:
    prod:
      memory:
        thresholdPercent: 80.0  # Lower threshold for production
        checkDuration: 3m       # Check for 3 minutes
        oomKillThreshold: 1     # Immediate action on OOMKill
        enabled: true
      remediation:
        enabled: true
        cooldownSeconds: 600  # 10 minutes cooldown in production
    
    staging:
      memory:
        thresholdPercent: 85.0  # Standard threshold
        checkDuration: 5m       # Check for 5 minutes
        oomKillThreshold: 2     # Standard threshold
        enabled: true
      remediation:
        enabled: true
        cooldownSeconds: 300  # 5 minutes cooldown
    
    dev:
      memory:
        thresholdPercent: 90.0  # Higher threshold for development
        checkDuration: 10m      # Check for 10 minutes
        oomKillThreshold: 3     # More tolerant in development
        enabled: true
      remediation:
        enabled: true
        cooldownSeconds: 120  # 2 minutes cooldown

remediation:
  enabled: true
  dryRun: false
  maxRetries: 3
  retryInterval: 10s
  autoRollbackEnabled: true
  autoScaleEnabled: true
  cooldownSeconds: 300  # 5 minutes default cooldown

notification:
  slack:
    enabled: true
    channel: "#kubeguardian"
    username: "KubeGuardian"
    iconEmoji: ":robot_face:"
